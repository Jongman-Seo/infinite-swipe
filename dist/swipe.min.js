/*!
 * infinite-swipe 1.1.0
 * https://github.com/mctenshi/infinite-swipe
 *
 * infinite swipe is fork of https://github.com/mctenshi/recopick-swipe
 *
 * (c) 2015 mctenshi (mctenshi@gmail.com)
 * Released under the MIT license
 */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";var b=function(){for(var a=document.createElement("div"),b="transform WebkitTransform MozTransform OTransform msTransform".split(" "),c="transition WebkitTransition MozTransition OTransition msTransition".split(" "),d=0;d<b.length;d++)if(void 0!==a.style[b[d]]&&void 0!==a.style[c[d]])return!0;return!1}(),c=function(b,c){c=a.extend({$targetWrap:null,$target:null,$prev:null,$next:null,$curr:null,total:1,transition_ms:200,infinite:!1,autoswipe_seconds:0,onPage:null},c),this.$el=b,this.$targetWrap=c.$targetWrap||b,this.$target=c.$target||b,this.p=1,this.offset=0,this.total=c.total,this.curr_px=0,this.disabled_touch=!1,this.options=c,this.init()};c.prototype={_setTransitionDuration:function(a){var b=this.$targetWrap.get(0);b.style.webkitTransitionDuration=a+"ms",b.style.mozTransitionDuration=a+"ms",b.style.msTransitionDuration=a+"ms",b.style.oTransitionDuration=a+"ms",b.style.transitionDuration=a+"ms"},init:function(){if(this.$el.addClass("infinite-swipe-stage"),this.$targetWrap.addClass("infinite-swipe-target-wrap"),this._setTransitionDuration(this.options.transition_ms),this.$target.addClass("infinite-swipe-target"),this.options.infinite){var a=this.$target.clone().attr("aria-hidden",!0).addClass("infinite-swipe-target-clone").css("left","-"+100*this.options.total+"%"),b=this.$target.clone().attr("aria-hidden",!0).addClass("infinite-swipe-target-clone").css("left",100*this.options.total+"%");a.insertBefore(this.$target),b.insertBefore(this.$target),this.$target=this.$target.parent().find(".infinite-swipe-target")}this.addListeners(),!this.options.infinite&&this.options.$prev&&this.options.$prev.toggleClass("disabled",1===this.p),this.options.autoswipe_seconds>0&&this.initAutoswipe()},initAutoswipe:function(){var a=this;this._as_next=function(){a._as_timeout_id&&clearTimeout(a._as_timeout_id),a._as_timeout_id=setTimeout(function(){a._as_pause||a.swipeNext(),a._as_timeout_id=null,a._as_next()},1e3*a.options.autoswipe_seconds)},this._as_resume_event=function(){a._as_next()},this._as_pause_event=function(){a._as_timeout_id&&(clearTimeout(a._as_timeout_id),a._as_timeout_id=null)},this._as_next(),this.$el.on("mouseenter focusin",this._as_pause_event).on("mouseleave focusout",this._as_resume_event)},onPrev:function(a){a.preventDefault(),a.stopPropagation(),(1!==this.p||this.options.infinite)&&this.swipePrev()},onNext:function(a){a.preventDefault(),a.stopPropagation(),(this.p!==this.total||this.options.infinite)&&this.swipeNext()},onDragLeft:function(b,c,d){if(!this._swiped){if(a(window).on("touchmove",this.disabled_touch),Math.abs(c)>5&&(this.p!==this.total||this.options.infinite))return b.preventDefault(),b.stopPropagation(),this._swiped=!0,this.curr_px=0,this._setTransitionDuration(0),void this.swipeNext();var e=d;this.animate_px(e)}},onDragRight:function(b,c,d){if(!this._swiped){if(a(window).on("touchmove",this.disabled_touch),Math.abs(c)>5&&(this.p!==this.total||this.options.infinite))return b.preventDefault(),b.stopPropagation(),this._swiped=!0,this.curr_px=0,this._setTransitionDuration(0),void this.swipePrev();var e=d;this.animate_px(e)}},onDragStart:function(a){this._setTransitionDuration(0)},onDragEnd:function(b){this._setTransitionDuration(this.options.transition_ms),this._swiped||this.animate(),this._swiped=!1,a(window).off("touchmove",this.disabled_touch)},onSwipeTotal:function(b,c){var d=this;this.total!==c&&(this.total=c,this.p>this.total&&(this.p=this.total),this.getWidth(!0),this.offset=0,this.animate(),this.$target.each(function(b){a(this).css("left",d.total*(d.offset+b)*100+"%")}))},onSwipePage:function(a,b){1>b||b>this.total||(this.p=b,this.animate())},onWindowResize:function(a){var b=this;setTimeout(function(){b.getWidth(!0),b.$targetWrap.addClass("infinite-swipe-resizing"),b.animate(0,function(){b.$targetWrap.removeClass("infinite-swipe-resizing")})},200)},addListeners:function(){var b=this,c="touchstart click",d=navigator.userAgent;d.indexOf("Android")>=0&&(c="touchstart"),this.options.$prev&&this.options.$prev.on(c,a.proxy(this.onPrev,this)),this.options.$next&&this.options.$next.on(c,a.proxy(this.onNext,this)),this._dragleft_event=function(){b.onDragLeft.apply(b,arguments)},this._dragright_event=function(){b.onDragRight.apply(b,arguments)},this._dragstart_event=function(){b.onDragStart.apply(b,arguments)},this._dragend_event=function(){b.onDragEnd.apply(b,arguments)},this._swipetotal_event=function(){b.onSwipeTotal.apply(b,arguments)},this._swipepage_event=function(){b.onSwipePage.apply(b,arguments)},this.$el.on("dragleft",this._dragleft_event).on("dragright",this._dragright_event).on("dragstart",this._dragstart_event).on("dragend",this._dragend_event).on("swipe_total",this._swipetotal_event).on("swipe_page",this._swipepage_event),this._resize_event=function(){b.onWindowResize()},a(window).on("resize orientationchange",this._resize_event)},removeListeners:function(){var b="touchstart click",c=navigator.userAgent;c.indexOf("Android")>=0&&(b="touchstart"),this.options.$prev&&this.options.$prev.off(b,a.proxy(this.onPrev,this)),this.options.$next&&this.options.$next.off(b,a.proxy(this.onNext,this)),this.$el.off("dragleft",this._dragleft_event).off("dragright",this._dragright_event).off("dragstart",this._dragstart_event).off("dragend",this._dragend_event).off("swipe_total",this._swipetotal_event).off("swipe_page",this._swipepage_event),a(window).off("resize orientationchange",this._resize_event)},getWidth:function(a){return(a||!this._w)&&(this._w=this.options.getWidth?this.options.getWidth():this.$target.width()),this._w},swipePrev:function(){this.animate(-1)},swipeNext:function(){this.animate(1)},animate:function(c,d){var e=this,f=this.p;c&&(this.p+=c),this.curr_px>30?this.p--:this.curr_px<-30&&this.p++,this.options.infinite?this.p===this.total+1?(this.p=1,this.offset++,this.$target.each(function(b){var c=e.total*(e.offset+b-1)*100;a(this).css("left",c+"%")})):0===this.p&&(this.p=this.total,this.offset--,this.$target.each(function(b){var c=e.total*(e.offset+b-1)*100;a(this).css("left",c+"%")})):this.p=Math.max(Math.min(this.p,this.total),1),this.curr_px=0;var g=-((this.p-1+this.offset*this.total)*this.getWidth())/this.total;b?this.$targetWrap.css({"-webkit-transform":"translate3D("+g+"px, 0, 0)","-moz-transform":"translate3D("+g+"px, 0, 0)","-ms-transform":"translate3D("+g+"px, 0, 0)","-o-transform":"translate3D("+g+"px, 0, 0)",transform:"translate3D("+g+"px, 0, 0)"}):this.$targetWrap.css("opacity",.7).animate({"margin-left":g+"px",opacity:1},this.options.transition_ms),this.options.infinite||(this.options.$prev&&this.options.$prev.toggleClass("disabled",1===this.p),this.options.$next&&this.options.$next.toggleClass("disabled",this.p===this.total)),this.options.$curr&&this.options.$curr.text(this.p),f!=this.p&&this.options.onPage&&this.options.onPage(this.p),d&&setTimeout(d,this.options.transition_ms)},animate_px:function(a){this.curr_px=a;var c=-((this.p-1+this.offset*this.total)*this.getWidth())/this.total+a;b?this.$targetWrap.css({"-webkit-transform":"translate3D("+c+"px, 0, 0)","-moz-transform":"translate3D("+c+"px, 0, 0)","-ms-transform":"translate3D("+c+"px, 0, 0)","-o-transform":"translate3D("+c+"px, 0, 0)",transform:"translate3D("+c+"px, 0, 0)"}):this.$targetWrap.css({"margin-left":c+"px",opacity:1})},destroy:function(){this.$el.removeClass("infinite-swipe-stage"),this.$targetWrap.removeClass("infinite-swipe-target-wrap"),this.$target.filter(".infinite-swipe-target-clone").remove(),this.$el.find(".infinite-swipe-target").removeClass("infinite-swipe-target"),this.removeListeners(),this.options.autoswipe_seconds>0&&this.$el.off("mouseenter focusin",this._as_pause_event).off("mouseleave focusout",this._as_resume_event)},pause:function(){this._as_pause=!0},resume:function(){this._as_pause=!1,this._as_next()}},a.fn.infiniteSwipeEvent=function(){var b,c=a(this),d=!1,e=null,f={x:null,y:null},g={x:null,y:null};c.on("touchstart",function(a){var c=a.originalEvent.touches[0].pageX,h=a.originalEvent.touches[0].pageY;d=!0,e=null,f.x=g.x=c,f.y=g.y=h,b=a.timeStamp}).on("touchend touchleave",function(a){d&&c.trigger("dragend"),d=!1}).on("touchmove",function(a){if(d&&"y"!==e){var h=a.originalEvent.touches[0].pageX,i=a.originalEvent.touches[0].pageY,j={x:g.x-h,y:g.y-i};if(!e){if(e=Math.abs(j.x)>=Math.abs(j.y)?"x":"y","y"===e)return;c.trigger("dragstart")}var k=a.timeStamp-b,l={x:f.x-h,y:f.y-i},m=Math.abs(j.x/k);j.x>0?c.trigger("dragleft",[m,-l.x]):j.x<0&&c.trigger("dragright",[m,-l.x]),g.x=h,g.y=i,b=a.timeStamp}})},a.fn.infiniteSwipe=function(b){return this.each(function(){if("string"==typeof b){var d=a(this).data("infiniteswipe");d&&d[b]()}else a(this).infiniteSwipeEvent(),a(this).data("infiniteswipe",new c(a(this),b))})}});