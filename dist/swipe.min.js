/*!
 * infinite-swipe v0.1.0
 * https://github.com/mctenshi/infinite-swipe
 *
 * infinite swipe is fork of https://github.com/mctenshi/recopick-swipe
 * Released under the MIT license
 */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";var b=function(){for(var a=document.createElement("div"),b="transform WebkitTransform MozTransform OTransform msTransform".split(" "),c="transition WebkitTransition MozTransition OTransition msTransition".split(" "),d=0;d<b.length;d++)if(void 0!==a.style[b[d]]&&void 0!==a.style[c[d]])return!0;return!1}(),c=function(c){c=a.extend({$target:null,$prev:null,$next:null,$curr:null,total:1,infinite:!1,transition_ms:300},c);var d,e=a(this),f=c.$target||e,g=1,h=0,i=c.total,j=0,k=!1;e.addClass("infinite-swipe-stage"),f.addClass("infinite-swipe-target").css({"-webkit-transition-delay":c.transition_ms,"-moz-transition-delay":c.transition_ms,"-ms-transition-delay":c.transition_ms,"-o-transition-delay":c.transition_ms,"transition-delay":c.transition_ms}),c.infinite&&(f.clone().attr("aria-hidden",!0).addClass("infinite-swipe-target-clone").css("left",100*c.total+"%").insertBefore(f),f=f.parent().find(".infinite-swipe-target"));var l=function(){var a;return function(b){return(b||!a)&&(a=c.getWidth?c.getWidth():f.width()),a}}(),m=function(){g--,o()},n=function(){g++,o()},o=function(e){j>30?g--:-30>j&&g++,0===g?c.infinite?(g=i,h--,f.each(function(b){a(this).css("left",i*(h+b)*100+"%")})):g=1:g===i+1&&(c.infinite?(g=1,h++,setTimeout(function(){f.each(function(b){a(this).css("left",i*(h+b)*100+"%")})},c.transition_ms)):g=i),j=0,d=-((g-1+h*i)*l())/i,b?f.css({"-webkit-transform":"translate3D("+d+"px, 0, 0)","-moz-transform":"translate3D("+d+"px, 0, 0)","-ms-transform":"translate3D("+d+"px, 0, 0)","-o-transform":"translate3D("+d+"px, 0, 0)",transform:"translate3D("+d+"px, 0, 0)"}):f.css("opacity",.7).animate({"margin-left":d+"px",opacity:1},c.transition_ms),c.infinite||(c.$prev&&c.$prev.toggleClass("disabled",1===g),c.$next&&c.$next.toggleClass("disabled",g===i)),c.$curr&&c.$curr.text(g),e&&setTimeout(e,c.transition_ms)},p=function(a){j=a,d=-((g-1+h*i)*l())/i+a,b?f.css({"-webkit-transform":"translate3D("+d+"px, 0, 0)","-moz-transform":"translate3D("+d+"px, 0, 0)","-ms-transform":"translate3D("+d+"px, 0, 0)","-o-transform":"translate3D("+d+"px, 0, 0)",transform:"translate3D("+d+"px, 0, 0)"}):f.css({"margin-left":d+"px",opacity:1})},q="touchstart click",r=navigator.userAgent;r.indexOf("Android")>=0&&(q="touchstart"),c.$prev&&c.$prev.on(q,function(a){a.preventDefault(),a.stopPropagation(),(1!==g||c.infinite)&&m()}),c.$next&&c.$next.on(q,function(a){a.preventDefault(),a.stopPropagation(),(g!==i||c.infinite)&&n()});var s=!1;e.on("dragleft",function(b,d,e){if(!s){if(a(window).on("touchmove",k),Math.abs(d)>5&&(g!==i||c.infinite))return b.preventDefault(),b.stopPropagation(),s=!0,j=0,f.removeClass("infinite-swipe-disabled-transition"),void n();var h=e;p(h)}}).on("dragright",function(b,d,e){if(!s){if(a(window).on("touchmove",k),Math.abs(d)>5&&(1!==g||c.infinite))return b.preventDefault(),b.stopPropagation(),s=!0,j=0,f.removeClass("infinite-swipe-disabled-transition"),void m();var h=e;p(h)}}).on("dragstart",function(a){f.addClass("infinite-swipe-disabled-transition")}).on("dragend",function(b){f.removeClass("infinite-swipe-disabled-transition"),s||o(),s=!1,a(window).off("touchmove",k)}).on("swipe_total",function(b,c){i!==c&&(i=c,g>i&&(g=i),l(!0),h=0,o(),f.each(function(b){a(this).css("left",i*(h+b)*100+"%")}))}).on("swipe_page",function(a,b){b>i||(g=b,o())}),a(window).on("resize orientationchange",function(a){l(!0),f.addClass("infinite-swipe-resizing"),o(function(){f.removeClass("infinite-swipe-resizing")})}),c.infinite||c.$prev&&c.$prev.toggleClass("disabled",1===g)};a.fn.infiniteSwipeEvent=function(){var b,c=a(this),d=!1,e=null,f={x:null,y:null},g={x:null,y:null};c.on("touchstart",function(a){var c=a.originalEvent.touches[0].pageX,h=a.originalEvent.touches[0].pageY;d=!0,e=null,f.x=g.x=c,f.y=g.y=h,b=a.timeStamp}).on("touchend touchleave",function(a){d&&c.trigger("dragend"),d=!1}).on("touchmove",function(a){if(d&&"y"!==e){var h=a.originalEvent.touches[0].pageX,i=a.originalEvent.touches[0].pageY,j={x:g.x-h,y:g.y-i};if(!e){if(e=Math.abs(j.x)>=Math.abs(j.y)?"x":"y","y"===e)return;c.trigger("dragstart")}var k=a.timeStamp-b,l={x:f.x-h,y:f.y-i},m=Math.abs(j.x/k);j.x>0?c.trigger("dragleft",[m,-l.x]):j.x<0&&c.trigger("dragright",[m,-l.x]),g.x=h,g.y=i,b=a.timeStamp}})},a.fn.infiniteSwipe=function(b){return this.each(function(){a(this).infiniteSwipeEvent(),c.call(this,b)})}});